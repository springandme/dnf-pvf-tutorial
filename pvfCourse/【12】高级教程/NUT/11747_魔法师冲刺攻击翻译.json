{
    "content": "<pre>\n<code>// “state”刻在这里，您将第一次进入。配置各种资源\nfunction onSetState_ATMageDashAttack(obj, state, datas, isResetTimer)\n{   \n    if (!obj)\n        return;\n \n    local skillLevel = obj.sq_GetSkillLevel(SKILL_ICE_ELEMENTAL_ATTACK);\n \n    // 学会了受体。\n    if (skillLevel &gt; 0)\n    {\n        local isPress = sq_IsKeyDown(OPTION_HOTKEY_MOVE_UP, ENUM_SUBKEY_TYPE_ALL) || sq_IsKeyDown(OPTION_HOTKEY_MOVE_DOWN, ENUM_SUBKEY_TYPE_ALL);\n         \n        // 对待攻击时前进处理\n        if(!isPress)\n            obj.sq_SetStaticMoveInfo(0, 450, 450, false, -500, true);\n         \n        // 使用基本技能\n        obj.applyBasicAttackUp(sq_GetCurrentAttackInfo(obj),obj.getState());        \n        sq_SetCurrentAttackInfo(obj, sq_GetCurrentAttackInfo(obj));\n    }\n    else\n    {\n        // 对待攻击时前进处理\n        obj.sq_SetStaticMoveInfo(0, 450, 450, false, -500, true);\n    }\n}\n \n// 攻击时产生魔法体.\nfunction onKeyFrameFlag_ATMageDashAttack(obj, flagIndex)\n{\n    if(!obj)\n        return false;\n    if (flagIndex == 1)\n    {\n        // 魔法的生成具体.\n        if (obj.sq_IsMyControlObject())\n        {\n            // 要生成的对象的索引\n            local passiveObjectIndex = 24261;\n            local power = -25;\n            // 人物技能的等级\n            local skillLevel = sq_GetSkillLevel(obj, SKILL_ELEMENTAL_CHANGE);\n \n            // 检查属性启动appendage中是否有.\n            local element = obj.getThrowElement();\n             \n            // 如果没有被属性启动，则发射了无属性平打\n            local appendage = obj.GetSquirrelAppendage(\"Character/ATMage/ElementalChange/ap_ATMage_Elemental_Change.nut\");\n            if (!appendage || !appendage.isValid())\n                element = ENUM_ELEMENT_NONE;\n \n            if (element != ENUM_ELEMENT_NONE)\n            {\n                if (element == ENUM_ELEMENT_FIRE)\n                    passiveObjectIndex = 24262;\n                else if (element == ENUM_ELEMENT_WATER)\n                    passiveObjectIndex = 24263;\n                else if (element == ENUM_ELEMENT_DARK)\n                    passiveObjectIndex = 24264;\n                else if (element == ENUM_ELEMENT_LIGHT)\n                    passiveObjectIndex = 24265;\n            }\n            else \n            {\n                //基本功熟练\n                sq_SetCurrentAttackBonusRate(sq_GetCurrentAttackInfo(obj),power);\n                obj.applyBasicAttackUp(sq_GetCurrentAttackInfo(obj),obj.getState());                    \n                power = sq_GetCurrentAttackBonusRate(obj);\n            }\n             \n            obj.sq_StartWrite();\n            obj.sq_WriteWord(80);   // 爆炸的尺寸(%)\n            obj.sq_WriteWord(power);    // 爆炸性攻击(%)\n            obj.sq_SendCreatePassiveObjectPacket(passiveObjectIndex, 0, 100, 1, 55);\n        }\n    }\n \n    return true;\n}</code></pre>\n\n<p>&nbsp;</p>",
    "auth_users": "学院搬运工",
    "img": "https://dafstatic.oss-cn-beijing.aliyuncs.com/static/title/level4.gif",
    "create_at": "2023-07-03T12:46:22.100",
    "view_num": 351
}